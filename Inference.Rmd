---
title: "Inference"
output: html_document
---

```{r}
library(ggplot2)
library(sandwich)
library(lmtest)
data = read.csv('./Data/results_pt_2.csv')
```

```{r}
bigmodLogit = lm(qlogis(auc)~years_between_train_eval*model, data=data)
bigmod = lm(auc~years_between_train_eval*model, data=data)
coeftest(bigmod, .vcov=vcovHC)
```

```{r}
library(dplyr)
data%>%group_by(model,years_between_train_eval)%>%summarize(auc=mean(auc))%>%ggplot(aes(years_between_train_eval,auc))+#,color=model))
  geom_point()+geom_line()+#geom_smooth(se=FALSE)+
  facet_wrap(~model,scales="free")
  #geom_smooth(method="lm",se=FALSE)

data%>%filter(model=="BKT")%>%group_by(model,years_between_train_eval)%>%summarize(auc=mean(auc))%>%ggplot(aes(years_between_train_eval,auc,color=model))+geom_point()+#geom_smooth(se=FALSE)+
  geom_smooth(method="lm",se=FALSE)

data%>%ggplot(aes(years_between_train_eval,auc))+geom_jitter()+geom_smooth(se=FALSE,color="red")+
  geom_smooth(method="lm",se=FALSE,color="blue")+facet_wrap(~model,scales="free")

plot(bigmod, which=c(1,3))
pred <- predict(bigmod)
ggplot(data,aes(years_between_train_eval,auc,color=model))+geom_point(alpha=0.2)+
  geom_line(aes(y=pred))
```


